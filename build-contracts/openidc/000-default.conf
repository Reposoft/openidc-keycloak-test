<VirtualHost *:80>
	ServerAdmin webmaster@localhost
	DocumentRoot htdocs/

	ErrorLog /proc/self/fd/1
	CustomLog /proc/self/fd/2 combined

	RequestHeader set X-Forwarded-Proto http
	ProxyPreserveHost On
	ProxyPass "/auth/realms/Testrealm/"  "http://keycloak:8080/auth/realms/Testrealm/"
	<Location "/auth/realms/Testrealm/">
		OIDCUnAuthAction pass
	</Location>

	OIDCProviderMetadataURL http://openidc/auth/realms/Testrealm/.well-known/openid-configuration
	OIDCRedirectURI http://openidc/protected/redirect_uri
	OIDCDefaultURL http://openidc/protected/
	OIDCCryptoPassphrase in-production-this-is-something-random
	OIDCClientID openid1

	# See fast if we accumulate state cookies
	LimitRequestFieldSize 4096

	Header setifempty Cache-Control "max-age=0, must-revalidate"

	RedirectTemp /logout http://openidc/protected/redirect_uri?logout=http%3A%2F%2Fopenidc%2F%3Fwe-have-no-loggedout-page-yet

	<Location /protected>
		AuthType openid-connect
		Require valid-user
	</Location>

	ScriptAlias "/protected/cgi/" "/usr/local/apache2/cgi-bin/"

</VirtualHost>
